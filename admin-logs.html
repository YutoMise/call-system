<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç∑„Çπ„ÉÜ„É†„É≠„Ç∞ - ÁÆ°ÁêÜËÄÖÁîªÈù¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 24px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
        }

        .nav-links a {
            color: #3498db;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .nav-links a:hover {
            background-color: #ecf0f1;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .controls-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        select, input, button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        button {
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2980b9;
        }

        .refresh-btn {
            background-color: #27ae60;
        }

        .refresh-btn:hover {
            background-color: #229954;
        }

        .clear-btn {
            background-color: #e74c3c;
        }

        .clear-btn:hover {
            background-color: #c0392b;
        }

        .auto-refresh-btn {
            background-color: #27ae60;
            transition: background-color 0.3s ease;
        }

        .auto-refresh-btn:hover {
            background-color: #229954;
        }

        .log-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .log-header {
            background-color: #34495e;
            color: white;
            padding: 15px 20px;
            font-weight: 500;
        }

        .log-content {
            max-height: 600px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 12px 20px;
            border-bottom: 1px solid #ecf0f1;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            transition: background-color 0.2s;
        }

        .log-entry:hover {
            background-color: #f8f9fa;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        /* „ÉÅ„É£„É≥„Éç„É´Âà•„Çø„Éñ„Çπ„Çø„Ç§„É´ */
        .channel-tabs {
            display: flex;
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 0;
            overflow-x: auto;
            white-space: nowrap;
        }

        .channel-tab {
            padding: 12px 20px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            min-width: 120px;
            position: relative;
        }

        .channel-tab:hover {
            background-color: #e9ecef;
            color: #495057;
        }

        .channel-tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
            background-color: white;
        }

        .channel-tab .tab-badge {
            display: inline-block;
            background-color: #dc3545;
            color: white;
            border-radius: 10px;
            padding: 2px 6px;
            font-size: 10px;
            margin-left: 8px;
            min-width: 16px;
            text-align: center;
        }

        .channel-tab.active .tab-badge {
            background-color: #3498db;
        }

        /* „É≠„Ç∞„Ç®„É≥„Éà„É™„ÅÆËâ≤ÂàÜ„Åë */
        .log-entry.connection-connect {
            border-left: 4px solid #27ae60;
            background-color: #f8fff9;
        }

        .log-entry.connection-disconnect {
            border-left: 4px solid #e74c3c;
            background-color: #fff8f8;
        }

        .log-entry.announcement {
            border-left: 4px solid #f39c12;
            background-color: #fffbf5;
        }

        .log-entry.error {
            border-left: 4px solid #e74c3c;
            background-color: #fff5f5;
        }

        .log-timestamp {
            color: #7f8c8d;
            font-weight: bold;
            margin-right: 10px;
        }

        .log-level {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 8px;
            min-width: 50px;
            text-align: center;
        }

        .log-level.ERROR {
            background-color: #e74c3c;
            color: white;
        }

        .log-level.WARN {
            background-color: #f39c12;
            color: white;
        }

        .log-level.INFO {
            background-color: #3498db;
            color: white;
        }

        .log-level.DEBUG {
            background-color: #95a5a6;
            color: white;
        }

        .log-type {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            background-color: #ecf0f1;
            color: #2c3e50;
            margin-right: 8px;
            min-width: 80px;
            text-align: center;
        }

        .log-message {
            color: #2c3e50;
        }

        .log-metadata {
            color: #7f8c8d;
            font-size: 11px;
            margin-top: 4px;
            padding-left: 20px;
        }

        .no-logs {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-style: italic;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #3498db;
        }

        .error-message {
            background-color: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .stats-summary {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .stat-card {
            background: #ecf0f1;
            padding: 10px 15px;
            border-radius: 4px;
            text-align: center;
            flex: 1;
        }

        .stat-number {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }

        .stat-label {
            font-size: 12px;
            color: #7f8c8d;
        }

        @media (max-width: 768px) {
            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }

            .control-group {
                width: 100%;
            }

            .stats-summary {
                flex-direction: column;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã „Ç∑„Çπ„ÉÜ„É†„É≠„Ç∞</h1>
            <div class="nav-links">
                <a href="/admin/channel/edit">„ÉÅ„É£„É≥„Éç„É´ÁÆ°ÁêÜ</a>
                <a href="/" target="_blank">„É°„Ç§„É≥„Éö„Éº„Ç∏</a>
                <button onclick="logout()" style="background: #e74c3c; border: none; color: white; padding: 8px 16px; border-radius: 4px; cursor: pointer;">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
            </div>
        </div>

        <div id="errorMessage" class="error-message" style="display: none;"></div>

        <div class="controls">
            <div class="stats-summary" id="statsSummary" style="display: none;">
                <div class="stat-card">
                    <div class="stat-number" id="totalLogs">-</div>
                    <div class="stat-label">Á∑è„É≠„Ç∞Êï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="announcements">-</div>
                    <div class="stat-label">„Ç¢„Éä„Ç¶„É≥„ÇπÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="errors">-</div>
                    <div class="stat-label">„Ç®„É©„ÉºÊï∞</div>
                </div>
            </div>

            <div class="controls-row">
                <div class="control-group">
                    <label>Ë°®Á§∫‰ª∂Êï∞</label>
                    <select id="limitSelect">
                        <option value="50">50‰ª∂</option>
                        <option value="100" selected>100‰ª∂</option>
                        <option value="200">200‰ª∂</option>
                        <option value="500">500‰ª∂</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>„É≠„Ç∞„É¨„Éô„É´</label>
                    <select id="levelFilter">
                        <option value="">„Åô„Åπ„Å¶</option>
                        <option value="ERROR">„Ç®„É©„Éº</option>
                        <option value="WARN">Ë≠¶Âëä</option>
                        <option value="INFO">ÊÉÖÂ†±</option>
                        <option value="DEBUG">„Éá„Éê„ÉÉ„Ç∞</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>„É≠„Ç∞„Çø„Ç§„Éó</label>
                    <select id="typeFilter">
                        <option value="">„Åô„Åπ„Å¶</option>
                        <option value="ANNOUNCEMENT">„Ç¢„Éä„Ç¶„É≥„Çπ</option>
                        <option value="CONNECTION">Êé•Á∂ö</option>
                        <option value="AUTHENTICATION">Ë™çË®º</option>
                        <option value="CHANNEL">„ÉÅ„É£„É≥„Éç„É´</option>
                        <option value="SYSTEM">„Ç∑„Çπ„ÉÜ„É†</option>
                        <option value="ERROR">„Ç®„É©„Éº</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="loadLogs()" class="refresh-btn">üîÑ Êõ¥Êñ∞</button>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="toggleAutoRefresh()" class="auto-refresh-btn" style="background-color: #27ae60;">üîÑ Ëá™ÂãïÊõ¥Êñ∞: ON</button>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="clearDisplay()" class="clear-btn">üóëÔ∏è ÁîªÈù¢„ÇØ„É™„Ç¢</button>
                </div>
            </div>
        </div>

        <div class="log-container">
            <!-- „ÉÅ„É£„É≥„Éç„É´Âà•„Çø„Éñ -->
            <div class="channel-tabs" id="channelTabs">
                <button class="channel-tab active" data-channel="all">
                    „Åô„Åπ„Å¶ <span class="tab-badge" id="badge-all">0</span>
                </button>
            </div>

            <div class="log-header">
                <span id="logTitle">„Ç∑„Çπ„ÉÜ„É†„É≠„Ç∞ (ÊúÄÊñ∞100‰ª∂)</span>
                <span style="float: right; font-size: 12px;" id="lastUpdate">-</span>
            </div>
            <div class="log-content" id="logContent">
                <div class="loading">„É≠„Ç∞„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
            </div>
        </div>
    </div>

    <script>
        let currentLogs = [];
        let autoRefresh = true;
        let refreshInterval = null;
        let currentChannel = 'all';
        let channelStats = {};
        let lastLogCount = 0;

        // Ë™çË®º„ÉÅ„Çß„ÉÉ„ÇØ
        async function checkAuth() {
            try {
                const response = await fetch('/admin/api/auth-status');
                const data = await response.json();
                if (!data.isAuthenticated) {
                    window.location.href = '/admin/channel/edit';
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Ë™çË®º„ÉÅ„Çß„ÉÉ„ÇØ„Ç®„É©„Éº:', error);
                return false;
            }
        }

        // „É≠„Ç∞„Ç¢„Ç¶„Éà
        async function logout() {
            try {
                await fetch('/admin/logout', { method: 'POST' });
                window.location.href = '/admin/channel/edit';
            } catch (error) {
                console.error('„É≠„Ç∞„Ç¢„Ç¶„Éà„Ç®„É©„Éº:', error);
            }
        }

        // „É≠„Ç∞Ë™≠„ÅøËæº„Åø
        async function loadLogs() {
            if (!await checkAuth()) return;

            const limit = document.getElementById('limitSelect').value;
            const logContent = document.getElementById('logContent');
            const errorMessage = document.getElementById('errorMessage');
            
            logContent.innerHTML = '<div class="loading">„É≠„Ç∞„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>';
            errorMessage.style.display = 'none';

            try {
                const response = await fetch(`/admin/api/logs?limit=${limit}`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const logs = await response.json();

                // Êñ∞„Åó„ÅÑ„É≠„Ç∞„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                const hasNewLogs = logs.length > lastLogCount;
                lastLogCount = logs.length;

                currentLogs = logs;
                await displayLogs(logs);
                updateStats();

                // Êñ∞„Åó„ÅÑ„É≠„Ç∞„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆË¶ñË¶öÁöÑ„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
                if (hasNewLogs && autoRefresh) {
                    const logHeader = document.querySelector('.log-header');
                    logHeader.style.backgroundColor = '#27ae60';
                    setTimeout(() => {
                        logHeader.style.backgroundColor = '#34495e';
                    }, 1000);
                }

                document.getElementById('lastUpdate').textContent =
                    `ÊúÄÁµÇÊõ¥Êñ∞: ${new Date().toLocaleTimeString('ja-JP')}`;
                
            } catch (error) {
                console.error('„É≠„Ç∞Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                errorMessage.textContent = `„É≠„Ç∞„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`;
                errorMessage.style.display = 'block';
                logContent.innerHTML = '<div class="no-logs">„É≠„Ç∞„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</div>';
            }
        }

        // „É≠„Ç∞Ë°®Á§∫
        async function displayLogs(logs) {
            const logContent = document.getElementById('logContent');
            const levelFilter = document.getElementById('levelFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const limit = document.getElementById('limitSelect').value;

            // „ÉÅ„É£„É≥„Éç„É´Âà•„Çø„Éñ„ÇíÊõ¥Êñ∞
            await updateChannelTabs(logs);

            // „Éï„Ç£„É´„Çø„É™„É≥„Ç∞
            let filteredLogs = logs;

            // „ÉÅ„É£„É≥„Éç„É´„Éï„Ç£„É´„Çø
            if (currentChannel !== 'all') {
                filteredLogs = filteredLogs.filter(log =>
                    log.metadata && log.metadata.channelName === currentChannel
                );
            } else {
                // „Äå„Åô„Åπ„Å¶„Äç„ÅÆÂ†¥Âêà„Åß„ÇÇ„Äå„Ç∑„Çπ„ÉÜ„É†„Äç„ÉÅ„É£„É≥„Éç„É´„ÅØÈô§Â§ñ
                filteredLogs = filteredLogs.filter(log =>
                    !log.metadata || !log.metadata.channelName || log.metadata.channelName !== '„Ç∑„Çπ„ÉÜ„É†'
                );
            }

            // „É¨„Éô„É´„Éï„Ç£„É´„Çø
            if (levelFilter) {
                filteredLogs = filteredLogs.filter(log => log.level === levelFilter);
            }

            // „Çø„Ç§„Éó„Éï„Ç£„É´„Çø
            if (typeFilter) {
                filteredLogs = filteredLogs.filter(log => log.type === typeFilter);
            }

            const channelText = currentChannel === 'all' ? '„Åô„Åπ„Å¶' : `„ÉÅ„É£„É≥„Éç„É´„Äå${currentChannel}„Äç`;
            document.getElementById('logTitle').textContent =
                `${channelText}„ÅÆ„É≠„Ç∞ (${filteredLogs.length}/${logs.length}‰ª∂Ë°®Á§∫)`;

            if (filteredLogs.length === 0) {
                logContent.innerHTML = '<div class="no-logs">Ë°®Á§∫„Åô„Çã„É≠„Ç∞„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }

            const logHtml = filteredLogs.map(log => {
                const metadata = log.metadata && Object.keys(log.metadata).length > 0
                    ? `<div class="log-metadata">${JSON.stringify(log.metadata, null, 2)}</div>`
                    : '';

                // „É≠„Ç∞„Ç®„É≥„Éà„É™„ÅÆ„ÇØ„É©„Çπ„ÇíÊ±∫ÂÆöÔºàËâ≤ÂàÜ„ÅëÁî®Ôºâ
                let entryClass = 'log-entry';
                if (log.type === 'CONNECTION' && log.metadata && log.metadata.action === 'connect') {
                    entryClass += ' connection-connect';
                } else if (log.type === 'CONNECTION' && log.metadata && log.metadata.action === 'disconnect') {
                    entryClass += ' connection-disconnect';
                } else if (log.type === 'ANNOUNCEMENT') {
                    entryClass += ' announcement';
                } else if (log.level === 'ERROR') {
                    entryClass += ' error';
                }

                return `
                    <div class="${entryClass}">
                        <span class="log-timestamp">${log.timestamp}</span>
                        <span class="log-level ${log.level}">${log.level}</span>
                        <span class="log-type">${log.type}</span>
                        <span class="log-message">${escapeHtml(log.message)}</span>
                        ${metadata}
                    </div>
                `;
            }).join('');

            logContent.innerHTML = logHtml;
        }

        // „ÉÅ„É£„É≥„Éç„É´„Çø„ÉñÊõ¥Êñ∞
        async function updateChannelTabs(logs) {
            const channelTabs = document.getElementById('channelTabs');

            // ÂÆüÈöõ„ÅÆ„ÉÅ„É£„É≥„Éç„É´‰∏ÄË¶ß„ÇíÂèñÂæó
            let validChannels = [];
            try {
                const response = await fetch('/admin/api/channels');
                if (response.ok) {
                    const channelsData = await response.json();
                    validChannels = channelsData.map(ch => ch.name);
                }
            } catch (error) {
                console.error('„ÉÅ„É£„É≥„Éç„É´‰∏ÄË¶ß„ÅÆÂèñÂæó„Å´Â§±Êïó:', error);
            }

            // „ÉÅ„É£„É≥„Éç„É´Âà•Áµ±Ë®à„ÇíË®àÁÆóÔºàÊúâÂäπ„Å™„ÉÅ„É£„É≥„Éç„É´„ÅÆ„ÅøÔºâ
            channelStats = { all: logs.length };
            logs.forEach(log => {
                if (log.metadata && log.metadata.channelName) {
                    const channel = log.metadata.channelName;
                    // ÊúâÂäπ„Å™„ÉÅ„É£„É≥„Éç„É´„ÅÆ„Åø„Ç´„Ç¶„É≥„ÉàÔºà„Äå„Ç∑„Çπ„ÉÜ„É†„Äç„ÅØÈô§Â§ñÔºâ
                    if (validChannels.includes(channel) && channel !== '„Ç∑„Çπ„ÉÜ„É†') {
                        channelStats[channel] = (channelStats[channel] || 0) + 1;
                    }
                }
            });

            // Êó¢Â≠ò„ÅÆ„Çø„Éñ„Çí„ÇØ„É™„Ç¢Ôºà„Äå„Åô„Åπ„Å¶„Äç„Çø„Éñ‰ª•Â§ñÔºâ
            const allTab = channelTabs.querySelector('[data-channel="all"]');
            channelTabs.innerHTML = '';
            channelTabs.appendChild(allTab);

            // „Äå„Åô„Åπ„Å¶„Äç„Çø„Éñ„ÅÆ„Éê„ÉÉ„Ç∏„ÇíÊõ¥Êñ∞
            document.getElementById('badge-all').textContent = channelStats.all;

            // ÊúâÂäπ„Å™„ÉÅ„É£„É≥„Éç„É´„ÅÆ„Åø„Çø„Éñ„Çí‰ΩúÊàê
            validChannels.sort().forEach(channel => {
                const count = channelStats[channel] || 0;
                if (count > 0) { // „É≠„Ç∞„Åå„ÅÇ„Çã„ÉÅ„É£„É≥„Éç„É´„ÅÆ„ÅøË°®Á§∫
                    const tab = document.createElement('button');
                    tab.className = 'channel-tab';
                    tab.setAttribute('data-channel', channel);
                    tab.innerHTML = `${channel} <span class="tab-badge">${count}</span>`;
                    tab.addEventListener('click', async () => await switchChannel(channel));
                    channelTabs.appendChild(tab);
                }
            });

            // ÁèæÂú®„ÅÆ„Çø„Éñ„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´
            updateActiveTab();
        }

        // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Çø„Éñ„ÅÆÊõ¥Êñ∞
        function updateActiveTab() {
            document.querySelectorAll('.channel-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-channel') === currentChannel) {
                    tab.classList.add('active');
                }
            });
        }

        // „ÉÅ„É£„É≥„Éç„É´Âàá„ÇäÊõø„Åà
        async function switchChannel(channel) {
            currentChannel = channel;
            updateActiveTab();
            await displayLogs(currentLogs);
        }

        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStats() {
            const totalLogs = currentLogs.length;
            const announcements = currentLogs.filter(log => log.type === 'ANNOUNCEMENT').length;
            const errors = currentLogs.filter(log => log.level === 'ERROR').length;

            document.getElementById('totalLogs').textContent = totalLogs;
            document.getElementById('announcements').textContent = announcements;
            document.getElementById('errors').textContent = errors;
            document.getElementById('statsSummary').style.display = 'flex';
        }

        // ÁîªÈù¢„ÇØ„É™„Ç¢
        function clearDisplay() {
            document.getElementById('logContent').innerHTML = '<div class="no-logs">„É≠„Ç∞„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü</div>';
            document.getElementById('statsSummary').style.display = 'none';
            document.getElementById('lastUpdate').textContent = '-';
        }

        // HTML„Ç®„Çπ„Ç±„Éº„Éó
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('limitSelect').addEventListener('change', async () => {
            if (currentLogs.length > 0) {
                await displayLogs(currentLogs);
            }
        });

        document.getElementById('levelFilter').addEventListener('change', async () => {
            if (currentLogs.length > 0) {
                await displayLogs(currentLogs);
            }
        });

        document.getElementById('typeFilter').addEventListener('change', async () => {
            if (currentLogs.length > 0) {
                await displayLogs(currentLogs);
            }
        });

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            // „Äå„Åô„Åπ„Å¶„Äç„Çø„Éñ„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíËøΩÂä†
            document.querySelector('[data-channel="all"]').addEventListener('click', async () => {
                await switchChannel('all');
            });

            loadLogs();

            // 5Áßí„Åî„Å®„Å´Ëá™ÂãïÊõ¥Êñ∞Ôºà„É™„Ç¢„É´„Çø„Ç§„É†ÊÑü„ÇíÂêë‰∏äÔºâ
            setInterval(() => {
                if (document.visibilityState === 'visible' && autoRefresh) {
                    loadLogs();
                }
            }, 5000);

            // Ëá™ÂãïÊõ¥Êñ∞„ÅÆÂàá„ÇäÊõø„ÅàÊ©üËÉΩ
            window.toggleAutoRefresh = function() {
                autoRefresh = !autoRefresh;
                const button = document.querySelector('.auto-refresh-btn');
                if (button) {
                    button.textContent = autoRefresh ? 'üîÑ Ëá™ÂãïÊõ¥Êñ∞: ON' : '‚è∏Ô∏è Ëá™ÂãïÊõ¥Êñ∞: OFF';
                    button.style.backgroundColor = autoRefresh ? '#27ae60' : '#95a5a6';
                }
            };
        });
    </script>
</body>
</html>
